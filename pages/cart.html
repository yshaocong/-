<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的购物车</title>
    <link type="text/css" href="../css/public.css" rel="stylesheet" />
    <link type="text/css" href="../css/index.css" rel="stylesheet" />
    <link type="text/css" href="../css/cart.css" rel="stylesheet" />
    <script src="../lib/jquery.min.js"></script>
    <script src="../js/public.js"></script>
</head>
<body>
    <div id="app" class="app">
        <div class="site-mini-header">
            <div class="container">
                <div class="header-logo"><a href="./index.html" title="小米官网"><img src="../images/index_61.jpg" alt=""></a></div>
                <div class="J_miniHeaderTitle">
                    <h2>我的购物车</h2>
                    <p>温馨提示：产品是否购买成功，以最终下单为准哦，请尽快结算</p>
                </div>
                <div class="site-topbar">
                    <div class="topbar-info">
                        <a href="./login.html">登录</a><span>|</span><a href="./register.html">注册</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="mi-cart clearfix">
            <div class="container">
                <div class="cart-container">
                    <div class="empty-cart-top on">
                        <h2 class="login-tip">您的购物车还是空的！</h2>
                        <p class="login-desc">登录后将显示您之前加入的商品</p>
                        <a href="./login.html">立即登录</a>
                        <a href="javascript:;">马上去购物</a>
                    </div>
                    <div class="cart-wrap">
                        <div class="cart-goods-list">
                            <div class="list-head">
                                <div class="col-check">
                                    <input type="checkbox">全选
                                </div>
                                <div class="col-img"></div>
                                <div class="col-name">商品名称</div>
                                <div class="col-price">单价</div>
                                <div class="col-num">数量</div>
                                <div class="col-total">小计</div>
                                <div class="col-action">操作</div>
                            </div>
                            <div class="list-body">
                                <div class="list-item">
                                    <div class="item-table" id="001">
                                        <div class="col-check">
                                            <input type="checkbox">
                                        </div>
                                        <div class="col-img"><a href=""><img src="../images/cart_2.png" alt=""></a></div>
                                        <div class="col-name"><h3><a href="javascript:;">小米10至尊纪念版</a></h3></div>
                                        <div class="col-price">5599元</div>
                                        <div class="col-num">
                                            <div class="change-goods-num">
                                                <a href="javascript:;" class="jian">-</a><input type="text" value="1"><a href="javascript:;" class="add">+</a>
                                            </div>
                                        </div>
                                        <div class="col-total">5599元</div>
                                        <div class="col-action"><a href="javascript:;" class="del">X</a></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="cart-bar">
                            <div class="section-left">
                               <a href="javascript:;">继续购物</a> 
                               <span>共<i>1</i> 件商品，已选择 <i>1</i>件</span>
                            </div>
                            <span class="total-price">
                                合计：<em>5599</em>元<a href="javascript:;">去结算</a>
                            </span>
                        </div>
                    </div>
                    <div class="cart-recommend">
                        <h2 class="recommend-title">
                            <span>买购物车中商品的人还买了</span>
                        </h2>
                        <div class="J_recommend_cartBuy">
                            <ul class="recommend-list">
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                                <li class="recommend-item">
                                    <a href="javascript:;"><img src="../images/cart_3.png" alt="">
                                        <div class="recommend-name">小米手环4 NFC版</div>
                                        <div class="recommend-price">179元</div>
                                        <div class="recommend-tips">50.8万人好评</div>
                                    </a>
                                    <div class="recommend-action">
                                        <a href="javascript:;">加入购物车</a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="site-footer">
            <div class="container">
                <div class="footer-service">
                    <ul class="list-service">
                        <li><a href="">
                            <img src="../images/index_53.jpg" alt="">
                            预约维修服务
                        </a></li>
                        <li><a href="">
                            <img src="../images/index_54.jpg" alt="">
                            7天无理由退货
                        </a></li>
                        <li><a href="">
                            <img src="../images/index_55.jpg" alt="">
                            15天免费退货
                        </a></li>
                        <li><a href="">
                            <img src="../images/index_56.jpg" alt="">
                            满99元包邮
                        </a></li>
                        <li><a href="">
                            <img src="../images/index_57.jpg" alt="">
                            520余家售后网点
                        </a></li>
                    </ul>
                </div>
                <div class="footer-links">
                    <dl class="col-links">
                        <dt>帮助中心</dt>
                        <dd><a href="">账户管理</a></dd>
                        <dd><a href="">购物指南</a></dd>
                        <dd><a href="">订单操作</a></dd>
                    </dl>
                    <dl class="col-links">
                        <dt>服务支持</dt>
                        <dd><a href="">售后政策</a></dd>
                        <dd><a href="">自助服务</a></dd>
                        <dd><a href="">相关下载</a></dd>
                    </dl>
                    <dl class="col-links">
                        <dt>线下门店</dt>
                        <dd><a href="">小米之家</a></dd>
                        <dd><a href="">服务网点</a></dd>
                        <dd><a href="">授权体验店</a></dd>
                    </dl>
                    <dl class="col-links">
                        <dt>关于小米</dt>
                        <dd><a href="">了解小米</a></dd>
                        <dd><a href="">加入小米</a></dd>
                        <dd><a href="">投资者关系</a></dd>
                        <dd><a href="">企业社会责任</a></dd>
                        <dd><a href="">廉洁举报</a></dd>
                    </dl>
                    <dl class="col-links">
                        <dt>关注我们</dt>
                        <dd><a href="">新浪微博</a></dd>
                        <dd><a href="">官方微信</a></dd>
                        <dd><a href="">联系我们</a></dd>
                        <dd><a href="">公益基金会</a></dd>
                    </dl>
                    <dl class="col-links">
                        <dt>特色服务</dt>
                        <dd><a href="">F码通道</a></dd>
                        <dd><a href="">礼物码</a></dd>
                        <dd><a href="">防伪查询</a></dd>
                    </dl>
                    <div class="col-contact">
                        <p class="phone">400-100-5678</p>
                        <p>8:00-18:00（仅收市话费）</p>
                        <a href="" class="kefu"><img src="../images/index_58.jpg" alt="">人工客服</a>
                        <div class="follow">关注小米：<a href=""></a><a href=""></a></div>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer">
            <div class="logo"><img src="../images/index_61.jpg" alt=""></div>
            <div class="info-text">
                <p class="sites">
                    <a href="">小米商城</a>
                    <span>|</span>
                    <a href="">MIUI</a>
                    <span>|</span>
                    <a href="">米家</a>
                    <span>|</span>
                    <a href="">米聊</a>
                    <span>|</span>
                    <a href="">多看</a>
                    <span>|</span>
                    <a href="">游戏</a>
                    <span>|</span>
                    <a href="">政企服务</a>
                    <span>|</span>
                    <a href="">小米天猫店</a>
                    <span>|</span>
                    <a href="">小米集团隐私政策</a>
                    <span>|</span>
                    <a href="">小米公司儿童信息保护规则</a>
                    <span>|</span>
                    <a href="">小米商城用户协议</a>
                    <span>|</span>
                    <a href="">问题反馈</a>
                    <span>|</span>
                    <a href="">Select Location</a>
                </p>
                <p>&copy;<a href="">mi.com</a>京ICP证110507号<a href="">京ICP备10046444号</a><a href="">京公网安备11010802020134号</a><a href="">京网文[2020]0276-042号</a><br />
                    <a href="">（京）网械平台备字（2018）第00005号</a><a href="">互联网药品信息服务资格证 (京)-非经营性-2014-0090</a><a href="">营业执照</a><a href="">医疗器械质量公告</a><br />
                    <a href="">增值电信业务许可证</a> 网络食品经营备案 京食药网食备202010048 <a href="">食品经营许可证</a><br />
                    违法和不良信息举报电话：171-5104-4404 <a href="">知识产权侵权投诉</a> 本网站所列数据，除特殊说明，所有数据均出自我司实验室测试
                </p>
            </div>
            <div class="info-links">
                <a href=""><img src="../images/index_62.jpg" alt=""></a>
                <a href=""><img src="../images/index_63.jpg" alt=""></a>
                <a href=""><img src="../images/index_64.jpg" alt=""></a>
                <a href=""><img src="../images/index_65.jpg" alt=""></a>
                <a href="">
                    <img class src="../images/index_66.png" alt="">
                    <img class="active" src="../images/index_67.png" alt="">
                </a>
            </div>
        </div>
    </div>
    <!-- 弹出加入购物车 -->
    <script>
        $('.J_recommend_cartBuy .recommend-list li').mouseenter(function(){
            $(this).children().eq(1).css('opacity','1')
            $(this).children().eq(1).animate({
                bottom:75,
            },100,'linear')
        }).mouseleave(function(){
            $(this).children().eq(1).animate({
                bottom:16,
            },100,'linear',function(){
                $(this).children().eq(1).css('opacity','0')
            })
        })
    </script>

    <!-- 图片 -->
    <script>       
        var flag=true;
        setInterval(function(){
            flag=!flag;
            if(flag){
                $('.info-links').children().eq(4).children().eq(0).addClass('active').siblings().removeClass('active')    
            }           
            if(!flag){
                $('.info-links').children().eq(4).children().eq(1).addClass('active').siblings().removeClass('active')
                
            }
        },2000)
    </script>

    <!-- 输入数量 -->
    <script>
        console.log($('.list-body .list-item .col-num .change-goods-num input').val())
        $('.list-body .list-item .col-num .change-goods-num input').on('blur',function(){
            console.log(1)
        })
    </script>

    <!-- 添加商品 -->
    <script>
        $('.recommend-list .recommend-item .recommend-action a').click(function(){
            $.ajax({
                url:'../interface/addwq.php',
                data:{
                    id:'002',
                    name:'小米手环4 NFC版',
                    price:179,
                    img:'../images/cart_6.png',
                    num:1
                },
                success:function(res){
                    if(res.code){
                        location.href="./cart.html";
                    }
                },
                dataType:'json'
            })
        })
    </script>

    <!-- 连接数据库，更新商品数量 -->
    <script>
        showTbody();
        function showTbody(){
            $.ajax({
                url:'../interface/showlist.php',
                success:function(res){
                    if(res.code){
                        var arr=res.data;
                        if(res.data){
                            $('.empty-cart-top').addClass('empty-cart-top on');
                            $('.cart-wrap').show();
                            $('.cart-goods-list .list-body').empty();
                            $.each(arr,function(index,item){
                                var col=item.product_price*item.product_num;
                                $('.cart-goods-list .list-body').append(
                                    `<div class="list-item">
                                    <div class="item-table" id="${item.product_id}">
                                        <div class="col-check">
                                            <input type="checkbox">
                                        </div>
                                        <div class="col-img"><a href="javascript:;"><img src="${item.product_img}" alt=""></a></div>
                                        <div class="col-name"><h3><a href="javascript:;">${item.product_name}</a></h3></div>
                                        <div class="col-price">${item.product_price}元</div>
                                        <div class="col-num">
                                            <div class="change-goods-num">
                                                <a href="javascript:;" class="jian">-</a><input type="text" value="${item.product_num}"><a href="javascript:;" class="add">+</a>
                                            </div>
                                        </div>
                                        <div class="col-total">${col}元</div>
                                        <div class="col-action"><a href="javascript:;" class="del">X</a></div>
                                    </div>
                                </div>`
                                )
                                $('.cart-bar .total-price em').html(col);
                            })
                        }
                    }else{
                        $('.empty-cart-top').removeClass('on');
                        $('.cart-wrap').hide();
                    }
                },
                dataType:'json',
                cache:false
            })
        }

        //输入商品数量
        /* console.log($('.list-body .list-item .col-num .change-goods-num input').attr('value')) */

        /* $('.list-body .list-item .col-num .change-goods-num input').bind('input propertychange',function(){
            console.log(2)
        }) */
        /* $('.list-body .list-item .col-num .change-goods-num input').change(function(){
            console.log(1)
            $.ajax({
                url:'../interface/updatewq.php',
                data:{
                    type:$(this).val(),
                    id:$(target).parents('.item-table').attr('id') 
                },
                success:function(res){
                    if(res.code){
                        showTbody();
                    }
                },
                dataType:'json'
            })
        }) */

        // 点击+增加一个商品数量,点击-减少一个商品数量
        $('.cart-goods-list .list-body').click(function(e){
            var target=e.target;
            if((target.className=='add')||(target.className=='jian')){
                $.ajax({
                    url:'../interface/updatewq.php',
                    data:{
                        type:target.className,
                       id:$(target).parents('.item-table').attr('id') 
                    },
                    success:function(res){
                        if(res.code){
                            showTbody();
                        }
                    },
                    dataType:'json'
                })
            }else if(target.className=='del'){
                // 点击删除按钮删除一个商品
                $.ajax({
                    url:'../interface/delwq.php',
                    data:{
                        id:$(target).parents('.item-table').attr('id')
                    },
                    success:function(res){
                        if(res.code){
                            showTbody();
                        }
                    },
                    dataType:'json'
                })
            }
        })
    </script>

    
</body>
</html>